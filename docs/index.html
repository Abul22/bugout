<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="yes" name="mobile-web-app-capable">
  <meta content="black" name="apple-mobile-web-app-status-bar-style">
  <title>Bugout client test page</title>
  <script src="bugout.min.js" type="application/javascript"></script>
</head>
<body>
<img src="bugout-logo.svg"/>
<h3 id="pk"></h3>
<p>Bugout client library loaded.</p>
<p>Open the developer console and connect to a server like this:</p>
<pre>
var b = new Bugout("SERVER-ADDRESS");

// watch for connection to the server
b.on("server", console.log.bind(null, "server"));

// watch for other parties joining server group
b.on("seen", console.log.bind(null, "seen"));

// watch for messages from server and others
b.on("message", console.log.bind(null, "message"));
</pre>

<p>Then wait until you see the server connection message.</p>
<p>This can take a minute or two while WebRTC connects.</p>

<pre>
// make an RPC API call on the server and log the result
b.rpc("ping", {"Hello": "world"}, console.log);

// Send a message to anyone listening (unencrypted)
b.send("This is my message.");

// Send a message to the server specifically (encrypted)
b.send("SERVER-ADDRESS", "Hello server.");
</pre>
</body>
<script>
// update the address if one was passed in
var pk = window.location.hash.substr(1);
if (pk) {
  var pretags = document.getElementsByTagName("pre");
  for (var p=0; p<pretags.length; p++) {
    pretags[p].innerHTML = pretags[p].innerHTML.replace("SERVER-ADDRESS", pk);
  }
}
</script>
<style>
  * { 
    box-sizing: border-box;
  }

  body {
    max-width: 800px;
    font-family: Arial;
    font-size: 1.25em;
    text-align: center;
    margin: auto;
    width: 100%;
    padding: 0.5em;
  }

  img {
    max-width: 100%;
  }

  pre {
    width: 100%;
    padding: 0.5em;
    border-radius: 3px;
    text-align: left;
    word-wrap: break-word;
    white-space: pre-wrap;
  }
</style>
</html>
